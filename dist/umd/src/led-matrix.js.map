{"version":3,"sources":["webpack://ledMatrix/webpack/universalModuleDefinition","webpack://ledMatrix/webpack/bootstrap","webpack://ledMatrix/./dist/esm/lib/core/character.js","webpack://ledMatrix/./dist/esm/lib/utils/bit-array.js","webpack://ledMatrix/./dist/esm/lib/core/character-sizer.js","webpack://ledMatrix/./dist/esm/lib/utils/event.js","webpack://ledMatrix/./dist/esm/lib/core/board.js","webpack://ledMatrix/./dist/esm/lib/core/character-dictionary.js","webpack://ledMatrix/./dist/esm/lib/core/character-json.js","webpack://ledMatrix/./dist/esm/lib/utils/exception.js","webpack://ledMatrix/./dist/esm/lib/core/panel.js","webpack://ledMatrix/./dist/esm/lib/core/scrollers/side-scrolling-panel.js","webpack://ledMatrix/./dist/esm/lib/core/scrollers/vertical-scrolling-panel.js","webpack://ledMatrix/./dist/esm/lib/core/scrollers/scroller-builder.js","webpack://ledMatrix/./dist/esm/lib/core/led-matrix.js","webpack://ledMatrix/./dist/esm/lib/player/rendering/renderer.js","webpack://ledMatrix/./dist/esm/lib/player/rendering/canva-renderer.js","webpack://ledMatrix/./dist/esm/lib/player/rendering/canva-renderers.js","webpack://ledMatrix/./dist/esm/lib/player/rendering/ascii-renderer.js","webpack://ledMatrix/./dist/esm/lib/player/rendering/renderer-builder.js","webpack://ledMatrix/./dist/esm/lib/player/panel-player.js","webpack://ledMatrix/./dist/esm/index.js"],"names":["Character","constructor","pattern","output","width","_pattern","_output","size","_width","_height","getColumn","index","column","i","push","atIndex","getRow","row","height","hasPattern","input","BitArray","values","_bitPerIndex","_size","length","_array","Uint8Array","Math","ceil","_pointer","pushAll","value","mask","_createMask","_matchesMask","_arrayIndex","forEach","atIndexRange","count","_arrayIndexOffset","floor","NearestNeighbor","scale","matrix","factor","ratio","h1","w2","h2","finalMatrix","Array","j","px","py","Event","handlers","on","handler","off","filter","h","trigger","data","slice","expose","params","onPropertyChange","_characters","_letterSpacing","letterSpacing","padding","PropertyChange","characters","_input","x","_padding","paddingAndSpacingWidth","_horizontalPaddingWidth","_totalSpacingWidth","map","character","reduce","accumulator","current","_verticalPaddingWidth","getColumnAtIndex","_createBitOffArrayOfLength","toReturn","some","characterColumn","concat","getRowAtIndex","charactersWithSpace","apply","load","dictionnary","escapeCharacter","delimiterWord","start","end","characterBuffer","find","CharacterDictionary","max","add","pendingCharacters","pendingPatterns","duplicatedPendingPatterns","array","indexOf","alreadyAddedPatterns","duplicatedPatterns","edit","pendingCharacter","edited","arr","delete","deleted","splice","import","path","success","fetch","then","response","text","CharactersJSON","parse","catch","error","export","json","JSON","stringify","patterns","Exception","throwIfNull","valueDescription","throwIfNegative","throwIfNotBetween","rangeFrom","rangeTo","getDescriptionForProperty","className","methodName","CLASS_NAME","Panel","name","_initiated","onNewSequence","_params","updateCurrentSequence","board","NewSequence","increment","reverse","scroller","widthDescription","fpsDescription","reverseDescription","GetCurrentSequence","sequence","panelIndex","indexUpperBound","_tickPanelIndex","generatePanelFrameAtIndex","_decrementIndex","_incrementIndex","SideScrollingPanel","currentIndex","columns","display","VerticalScrollingPanel","ScrollerType","build","scrollerType","onReady","_validateParameters","_scrollerType","_panel","panelWidth","ScrollerBuilder","event","newSequence","_dictionary","Ready","addCharacters","addCharacter","editCharacter","deleteCharacter","loadedCharacters","usedCharacters","spacing","viewportWidth","defaultParams","_valueOrDefault","defaultValue","Renderer","parameters","render","_parameters","element","document","getElementById","elementId","clientHeight","clientWidth","colorBitOn","colorBitOff","colorStrokeOn","colorStrokeOff","ctx","getContext","clearRect","widthEachBit","heightEachBit","lineWidth","renderBitsOfValue","fillColor","strokeColor","strokeStyle","fillStyle","beginPath","moveToNextBit","drawBit","fill","stroke","CanvaRenderers","Ellipse","w","moveTo","radW","radH","ellipse","PI","Rect","context","rect","characterBitOn","characterBitOff","innerHTML","RendererType","rendererType","ASCII","CanvasSquare","CanvasCircle","PanelPlayer","onPanelUpdate","onReachingBoundary","_index","fps","_renderer","renderer","_sequence","PanelUpdate","ReachingBoundary","_fps","_fpsIntervalLengthInMs","_render","play","_startLoop","stop","_shouldUpdate","resume","pause","step","_nextPanelFrame","seek","frame","seekDescription","setRendererFromBuilder","RendererBuilder","reachedBoundary","_then","Date","now","_loop","requestAnimationFrame","bind","_callIfReadyForNextFrame","callback","_now","_elapsed"],"mappings":"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","file":"./src/led-matrix.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ledMatrix\"] = factory();\n\telse\n\t\troot[\"ledMatrix\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export default class Character {\n    constructor(pattern, output, width) {\n        this._pattern = pattern;\n        this._output = output;\n        if (output.size >= width) {\n            this._width = width;\n        }\n        else {\n            throw `Output size (${output.size}) can't be smaller than the character's width (${width})`;\n        }\n        if (output.size % width === 0) {\n            this._height = output.size / width;\n        }\n        else {\n            throw `Output size (${output.size}) must be divisible by the character's width (${width})`;\n        }\n    }\n    getColumn(index) {\n        if (index < 0) {\n            throw `Index (${index}) cannot be negative`;\n        }\n        if (index >= this._width) {\n            throw `Index (${index}) is greater than the width of the character (${this._width})`;\n        }\n        let column = [];\n        for (let i = 0; i < this._height; i++) {\n            column.push(this._output.atIndex(i * this._width + index));\n        }\n        return column;\n    }\n    getRow(index) {\n        if (index < 0) {\n            throw `Index (${index}) cannot be negative`;\n        }\n        if (index >= this._height) {\n            throw `Index (${index}) is greater than the height of the character (${this._height})`;\n        }\n        let row = [];\n        for (let i = 0; i < this._width; i++) {\n            row.push(this._output.atIndex(index * this._width + i));\n        }\n        return row;\n    }\n    get width() {\n        return this._width;\n    }\n    get height() {\n        return this._height;\n    }\n    get pattern() {\n        return this._pattern;\n    }\n    get output() {\n        return this._output;\n    }\n    hasPattern(input) {\n        return this._pattern == input;\n    }\n}\n;\n//# sourceMappingURL=character.js.map","export default class BitArray {\n    constructor(values) {\n        this._bitPerIndex = 8;\n        this._size = values.length;\n        this._array = new Uint8Array(Math.ceil(this._size / this._bitPerIndex));\n        this._pointer = 0;\n        this.pushAll(values);\n    }\n    get size() {\n        return this._size;\n    }\n    push(value) {\n        if (this._pointer == this._size) {\n            throw `Bit array max size reached (${this._size})`;\n        }\n        const mask = this._createMask(this._pointer);\n        if (this._matchesMask(mask, this._array[this._arrayIndex(this._pointer)])) {\n            if (value === 0) {\n                this._array[this._arrayIndex(this._pointer)] ^= mask;\n            }\n        }\n        else {\n            if (value === 1) {\n                this._array[this._arrayIndex(this._pointer)] ^= mask;\n            }\n        }\n        this._pointer++;\n    }\n    pushAll(values) {\n        values.forEach((value) => {\n            this.push(value);\n        });\n    }\n    atIndex(index) {\n        if (index > this._size) {\n            throw `Index (${index}) exceeds the size of the bit array (${this._size})`;\n        }\n        const mask = this._createMask(index);\n        return this._matchesMask(mask, this._array[this._arrayIndex(index)]) ? 1 : 0;\n    }\n    atIndexRange(index, count) {\n        if (index + count - 1 > this._size) {\n            throw `Index (${index}) exceeds the size of the bit array (${this._size})`;\n        }\n        const values = [];\n        for (let i = 0; i < count; i++) {\n            const mask = this._createMask(index + i);\n            values.push(this._matchesMask(mask, this._array[this._arrayIndex(index + i)]) ? 1 : 0);\n        }\n        return values;\n    }\n    _matchesMask(mask, value) {\n        return (mask & value) != 0;\n    }\n    _createMask(index) {\n        return 1 << (this._bitPerIndex - 1) - this._arrayIndexOffset(index);\n    }\n    _arrayIndex(index) {\n        return Math.floor(index / this._bitPerIndex);\n    }\n    _arrayIndexOffset(index) {\n        return index % this._bitPerIndex;\n    }\n}\n;\n//# sourceMappingURL=bit-array.js.map","export class NearestNeighbor {\n    static scale(matrix, width, factor) {\n        const ratio = 1 / factor;\n        const h1 = matrix.length / width;\n        const w2 = width * factor;\n        const h2 = h1 * factor;\n        let finalMatrix = new Array(w2 * h2);\n        for (let i = 0; i < h2; i++) {\n            for (let j = 0; j < w2; j++) {\n                const px = Math.floor(j * ratio);\n                const py = Math.floor(i * ratio);\n                finalMatrix[(i * w2) + j] = matrix[(py * width) + px];\n            }\n        }\n        return finalMatrix;\n    }\n}\n//# sourceMappingURL=character-sizer.js.map","export class Event {\n    constructor() {\n        this.handlers = [];\n    }\n    on(handler) {\n        this.handlers.push(handler);\n    }\n    off(handler) {\n        this.handlers = this.handlers.filter(h => h !== handler);\n    }\n    trigger(data) {\n        this.handlers.slice(0).forEach(h => h(data));\n    }\n    expose() {\n        return this;\n    }\n}\n//# sourceMappingURL=event.js.map","import Character from './character';\nimport BitArray from '../utils/bit-array';\nimport { NearestNeighbor } from \"./character-sizer\";\nimport { Event } from '../utils/event';\nexport default class Board {\n    constructor(params) {\n        this.onPropertyChange = new Event();\n        this._characters = [];\n        this._letterSpacing = params.letterSpacing;\n        this.padding = params.padding;\n        this._size = params.size;\n        this.onPropertyChange.trigger();\n    }\n    get PropertyChange() { return this.onPropertyChange.expose(); }\n    set letterSpacing(value) {\n        if (value == null) {\n            throw `Board's spacing cannot be set to null`;\n        }\n        if (value < 0) {\n            throw `Board's spacing cannot be set to a negative number (${value})`;\n        }\n        this._letterSpacing = value;\n        this.onPropertyChange.trigger();\n    }\n    get letterSpacing() {\n        return this._letterSpacing;\n    }\n    get characters() {\n        return this._characters;\n    }\n    get input() {\n        return this._input;\n    }\n    get size() {\n        return this._size;\n    }\n    set padding(value) {\n        value.forEach(x => {\n            if (x == null) {\n                throw `Board's padding cannot set to null`;\n            }\n            if (x < 0) {\n                throw `Board's padding cannot be set to a negative number (${value})`;\n            }\n        });\n        if (value.length == 1) {\n            this._padding = [value[0], value[0], value[0], value[0]];\n        }\n        else if (value.length == 2) {\n            this._padding = [value[0], value[1], value[0], value[1]];\n        }\n        else {\n            this._padding = value;\n        }\n        this.onPropertyChange.trigger();\n    }\n    get padding() {\n        return this._padding;\n    }\n    get width() {\n        const paddingAndSpacingWidth = this._horizontalPaddingWidth() + this._totalSpacingWidth();\n        if (this._characters.length > 0) {\n            return paddingAndSpacingWidth + this._characters\n                .map(character => character.width)\n                .reduce((accumulator, current) => accumulator + current);\n        }\n        else {\n            return paddingAndSpacingWidth;\n        }\n    }\n    get height() {\n        if (this._characters.length > 0) {\n            return this._verticalPaddingWidth() +\n                this._characters\n                    .reduce((accumulator, current) => current.height > accumulator.height ? current : accumulator).height;\n        }\n        else {\n            return this._verticalPaddingWidth();\n        }\n    }\n    getColumnAtIndex(index) {\n        index %= this.width;\n        if (index < this._padding[3] || index >= this.width - this._padding[1]) {\n            return this._createBitOffArrayOfLength(this.height + this._verticalPaddingWidth());\n        }\n        let accumulator = this._padding[3];\n        let toReturn;\n        this._characters.some((character) => {\n            accumulator += character.width;\n            if (accumulator > index) {\n                const characterColumn = character.getColumn(index - (accumulator - character.width));\n                toReturn = this._createBitOffArrayOfLength(this._padding[0])\n                    .concat(characterColumn)\n                    .concat(this._createBitOffArrayOfLength(this._padding[2]))\n                    .concat(characterColumn.length < this.height ? this._createBitOffArrayOfLength(this.height - characterColumn.length) : []);\n                return true;\n            }\n            accumulator += this._letterSpacing;\n            if (accumulator > index) {\n                toReturn = this._createBitOffArrayOfLength(this.height + this._verticalPaddingWidth());\n                return true;\n            }\n        });\n        return toReturn;\n    }\n    getRowAtIndex(index) {\n        index %= this.height;\n        if (index < this._padding[0] || index >= this.height - this._padding[2]) {\n            return this._createBitOffArrayOfLength(this.width);\n        }\n        let charactersWithSpace = [].concat.apply([], this._characters.map(x => x.getRow(index - this._padding[0]).concat(this._createBitOffArrayOfLength(this._letterSpacing))));\n        charactersWithSpace = charactersWithSpace.slice(0, charactersWithSpace.length - this._letterSpacing);\n        return this._createBitOffArrayOfLength(this._padding[3])\n            .concat(charactersWithSpace)\n            .concat(this._createBitOffArrayOfLength(this._padding[1]));\n    }\n    load(input, dictionnary, size = 1) {\n        const escapeCharacter = '\\\\';\n        const delimiterWord = {\n            start: \"(\",\n            end: \")\"\n        };\n        this._characters = [];\n        this._size = size;\n        for (let i = 0; i < input.length; i++) {\n            let characterBuffer = input[i];\n            if (characterBuffer === escapeCharacter) {\n                if (i == input.length - 1) {\n                    throw `No character escaped at the end of the string input`;\n                }\n                characterBuffer = input[++i];\n            }\n            else if (characterBuffer === delimiterWord.start && (i === 0 || input[i - 1] !== escapeCharacter)) {\n                do {\n                    characterBuffer += input[++i];\n                    if (i == input.length) {\n                        throw `Could not find the ending delimiter \"${delimiterWord.end}\" for pattern ${characterBuffer}`;\n                    }\n                } while (input[i] != delimiterWord.end);\n                characterBuffer = characterBuffer.slice(1, -1);\n            }\n            const character = dictionnary.find(characterBuffer);\n            this._characters.push(new Character(character.pattern, new BitArray(NearestNeighbor.scale(character.output.atIndexRange(0, character.output.size), character.width, this._size)), character.width * this._size));\n        }\n        this._input = input;\n        this.onPropertyChange.trigger();\n    }\n    _horizontalPaddingWidth() {\n        return this._padding[1] + this._padding[3];\n    }\n    _totalSpacingWidth() {\n        return (this._characters.length - 1) * this._letterSpacing;\n    }\n    _verticalPaddingWidth() {\n        return this._padding[0] + this._padding[2];\n    }\n    _createBitOffArrayOfLength(length) {\n        return Array.apply(null, Array(length)).map(() => 0);\n    }\n}\n;\n//# sourceMappingURL=board.js.map","export default class CharacterDictionary {\n    constructor() {\n        this._characters = [];\n    }\n    find(input) {\n        const character = this._characters.filter(x => x.hasPattern(input));\n        if (character && character.length > 0) {\n            return character[0];\n        }\n        throw `Could not find character ${input} in the alphabet`;\n    }\n    get characters() {\n        return this._characters;\n    }\n    get height() {\n        return Math.max.apply(Math, this._characters.map(x => x.height));\n    }\n    get length() {\n        return this._characters.length;\n    }\n    add(pendingCharacters) {\n        const pendingPatterns = pendingCharacters.map(x => x.pattern);\n        const duplicatedPendingPatterns = pendingPatterns.filter((value, index, array) => {\n            return array.indexOf(value) != index;\n        });\n        if (duplicatedPendingPatterns.length > 0) {\n            throw `Pattern already used by another pending character`;\n        }\n        if (this._characters.length > 0) {\n            const alreadyAddedPatterns = this._characters.map(x => x.pattern);\n            const duplicatedPatterns = alreadyAddedPatterns.filter((value) => {\n                return pendingPatterns.indexOf(value) != -1;\n            });\n            if (duplicatedPatterns.length > 0) {\n                throw `Pattern already used by another character`;\n            }\n        }\n        this._characters.push(...pendingCharacters);\n    }\n    edit(pendingCharacter) {\n        let edited = false;\n        this._characters.forEach((character, index, arr) => {\n            if (character.pattern == pendingCharacter.pattern && !edited) {\n                arr[index] = pendingCharacter;\n                edited = true;\n            }\n        });\n        if (!edited) {\n            throw `Could not find character ${pendingCharacter.pattern} in the alphabet. Aborted edit operation`;\n        }\n    }\n    delete(pendingCharacter) {\n        let deleted = false;\n        this._characters.forEach((character, index, arr) => {\n            if (character.pattern == pendingCharacter.pattern && !deleted) {\n                arr.splice(index, 1);\n                deleted = true;\n            }\n        });\n        if (!deleted) {\n            throw `Could not find character ${pendingCharacter.pattern} in the alphabet. Aborted delete operation`;\n        }\n    }\n}\n;\n//# sourceMappingURL=character-dictionary.js.map","import Character from \"./character\";\nimport BitArray from \"../utils/bit-array\";\nexport class CharactersJSON {\n    static import(path, success) {\n        fetch(path)\n            .then((response) => {\n            return response.text();\n        })\n            .then((response) => {\n            success(CharactersJSON.parse(response));\n        })\n            .catch((error) => {\n            throw `Couldn't fetch file: ${path}`;\n        });\n    }\n    static export() {\n    }\n    static parse(json) {\n        const data = JSON.parse(json);\n        if (data == null) {\n            throw 'Invalid character json file';\n        }\n        if (data.characters == null) {\n            throw 'Invalid character json file: Can\\'t find property characters';\n        }\n        return data.characters.map(x => {\n            if (x.pattern == null) {\n                throw 'Invalid character json file: Can\\'t find property patterns for a character';\n            }\n            if (x.output == null) {\n                throw 'Invalid character json file: Can\\'t find property output for a character';\n            }\n            if (x.width == null) {\n                throw 'Invalid character json file: Can\\'t find property width for a character';\n            }\n            return new Character(x.pattern, new BitArray(x.output.map(x => x)), x.width);\n        });\n    }\n    static stringify(characters) {\n        if (characters == null || characters.length == 0) {\n            return JSON.stringify(\"\");\n        }\n        return JSON.stringify({\n            characters: characters.map(x => {\n                return {\n                    patterns: x.pattern,\n                    output: x.output.atIndexRange(0, x.output.size),\n                    width: x.width\n                };\n            })\n        });\n    }\n}\n//# sourceMappingURL=character-json.js.map","export class Exception {\n    static throwIfNull(value, valueDescription) {\n        if (value == null) {\n            throw `${valueDescription} property cannot be set to null`;\n        }\n    }\n    static throwIfNegative(value, valueDescription) {\n        if (value < 0) {\n            throw `${valueDescription} property cannot be set to a negative number (${value})`;\n        }\n    }\n    static throwIfNotBetween(value, valueDescription, rangeFrom, rangeTo) {\n        if (value < rangeFrom || value > rangeTo) {\n            throw `Seek expects a value between ${rangeFrom} and ${rangeTo}`;\n        }\n    }\n    static getDescriptionForProperty(className, methodName) {\n        return `${className}'s ${methodName}`;\n    }\n}\n//# sourceMappingURL=exception.js.map","import { Exception } from '../utils/exception';\nimport { Event } from '../utils/event';\nexport class Panel {\n    constructor(params) {\n        this.CLASS_NAME = Panel.name;\n        this._initiated = false;\n        this.onNewSequence = new Event();\n        this._params = params;\n        this._initiated = true;\n        this.updateCurrentSequence();\n        this._params.board.PropertyChange.on(() => {\n            this.updateCurrentSequence();\n        });\n    }\n    get NewSequence() { return this.onNewSequence.expose(); }\n    get width() {\n        return this._params.width;\n    }\n    get board() {\n        return this._params.board;\n    }\n    get increment() {\n        return this._params.increment;\n    }\n    get reverse() {\n        return this._params.reverse;\n    }\n    get scroller() {\n        return this._params.scroller;\n    }\n    set width(value) {\n        const widthDescription = Exception.getDescriptionForProperty(this.CLASS_NAME, 'width');\n        Exception.throwIfNull(value, widthDescription);\n        Exception.throwIfNegative(value, widthDescription);\n        if (this._params.width != value) {\n            this._params.width = value;\n            this.updateCurrentSequence();\n        }\n    }\n    set board(value) {\n        Exception.throwIfNull(value, Exception.getDescriptionForProperty(this.CLASS_NAME, 'board'));\n        if (this._params.board != value) {\n            this._params.board = value;\n            this.updateCurrentSequence();\n        }\n    }\n    set increment(value) {\n        const fpsDescription = Exception.getDescriptionForProperty(this.CLASS_NAME, 'fps');\n        Exception.throwIfNull(value, fpsDescription);\n        Exception.throwIfNegative(value, fpsDescription);\n        if (this._params.increment != value) {\n            this._params.increment = value;\n            this.updateCurrentSequence();\n        }\n    }\n    set reverse(value) {\n        const reverseDescription = Exception.getDescriptionForProperty(this.CLASS_NAME, 'reverse');\n        Exception.throwIfNull(value, reverseDescription);\n        if (value != this._params.reverse) {\n            this._params.reverse = value;\n            this.updateCurrentSequence();\n        }\n    }\n    set scroller(value) {\n        const reverseDescription = Exception.getDescriptionForProperty(this.CLASS_NAME, 'reverse');\n        Exception.throwIfNull(value, reverseDescription);\n        if (value != this._params.scroller) {\n            this._params.scroller = value;\n            this.updateCurrentSequence();\n        }\n    }\n    GetCurrentSequence() {\n        let sequence = [];\n        let panelIndex = 0;\n        for (let i = 0; i <= this._params.scroller.indexUpperBound(this._params); i++) {\n            panelIndex = this._tickPanelIndex(panelIndex);\n            sequence.push(this._params.scroller.generatePanelFrameAtIndex(panelIndex, this._params));\n        }\n        return sequence;\n    }\n    updateCurrentSequence() {\n        if (this._initiated) {\n            const sequence = this.GetCurrentSequence();\n            this.onNewSequence.trigger({ sequence });\n        }\n    }\n    _tickPanelIndex(index) {\n        return this._params.reverse ? this._decrementIndex(index) : this._incrementIndex(index);\n    }\n    _incrementIndex(index) {\n        return index >= this._params.scroller.indexUpperBound(this._params) ? 0 : index + this._params.increment;\n    }\n    _decrementIndex(index) {\n        return index === 0 ? this._params.scroller.indexUpperBound(this._params) : index - this._params.increment;\n    }\n}\n;\n//# sourceMappingURL=panel.js.map","export default class SideScrollingPanel {\n    indexUpperBound(params) {\n        return params.board.width - 1;\n    }\n    generatePanelFrameAtIndex(currentIndex, params) {\n        let columns = [];\n        for (let i = 0; i < params.width; i++) {\n            columns.push(params.board.getColumnAtIndex(currentIndex + i));\n        }\n        let display = [];\n        for (let i = 0; i < columns[0].length; i++) {\n            display.push(columns.map(x => x[i]));\n        }\n        return display;\n    }\n}\n//# sourceMappingURL=side-scrolling-panel.js.map","export default class VerticalScrollingPanel {\n    indexUpperBound(params) {\n        return params.board.height - 1;\n    }\n    generatePanelFrameAtIndex(currentIndex, params) {\n        let display = [];\n        for (let i = 0; i < params.board.height; i++) {\n            let row;\n            row = params.board.getRowAtIndex(currentIndex + i);\n            display.push(row.slice(0, params.width));\n        }\n        return display;\n    }\n}\n//# sourceMappingURL=vertical-scrolling-panel.js.map","import SideScrollingPanel from \"./side-scrolling-panel\";\nimport VerticalScrollingPanel from \"./vertical-scrolling-panel\";\nexport var ScrollerType;\n(function (ScrollerType) {\n    ScrollerType[ScrollerType[\"SideScrollingPanel\"] = 0] = \"SideScrollingPanel\";\n    ScrollerType[ScrollerType[\"VerticalScrollingPanel\"] = 1] = \"VerticalScrollingPanel\";\n})(ScrollerType || (ScrollerType = {}));\nexport class ScrollerBuilder {\n    static build(scrollerType) {\n        switch (scrollerType) {\n            case ScrollerType.SideScrollingPanel:\n                return new SideScrollingPanel();\n            case ScrollerType.VerticalScrollingPanel:\n                return new VerticalScrollingPanel();\n        }\n    }\n}\n//# sourceMappingURL=scroller-builder.js.map","import Board from \"./board\";\nimport { Panel } from \"./panel\";\nimport { ScrollerBuilder, ScrollerType } from \"./scrollers/scroller-builder\";\nimport { Event } from \"../utils/event\";\nimport CharacterDictionary from \"./character-dictionary\";\nexport class LedMatrix {\n    constructor(params) {\n        this.onReady = new Event();\n        this._params = this._validateParameters(params);\n        this._scrollerType = this._params.scrollerType;\n        this._panel = new Panel({\n            board: new Board({\n                letterSpacing: this._params.letterSpacing,\n                padding: this._params.padding,\n                size: this._params.size\n            }),\n            increment: this._params.increment,\n            reverse: this._params.reverse,\n            width: this._params.panelWidth,\n            scroller: ScrollerBuilder.build(this._params.scrollerType)\n        });\n        this.event = {\n            newSequence: this._panel.NewSequence\n        };\n        this._dictionary = new CharacterDictionary();\n    }\n    get Ready() { return this.onReady.expose(); }\n    get size() {\n        return this._size;\n    }\n    set size(value) {\n        this._size = value;\n        this._panel.board.load(this.input, this._dictionary, this.size);\n    }\n    get indexUpperBound() {\n        return this._panel.scroller.indexUpperBound(this._panel);\n    }\n    addCharacters(characters) {\n        this._dictionary.add(characters);\n    }\n    addCharacter(character) {\n        this._dictionary.add([character]);\n    }\n    editCharacter(character) {\n        this._dictionary.edit(character);\n    }\n    deleteCharacter(character) {\n        this._dictionary.delete(character);\n    }\n    get loadedCharacters() {\n        return this._dictionary.characters;\n    }\n    get usedCharacters() {\n        return this._panel.board.characters;\n    }\n    set spacing(value) {\n        this._panel.board.letterSpacing = value;\n    }\n    get spacing() {\n        return this._panel.board.letterSpacing;\n    }\n    set padding(value) {\n        this._panel.board.padding = value;\n    }\n    get padding() {\n        return this._panel.board.padding;\n    }\n    get width() {\n        return this._panel.board.width;\n    }\n    get height() {\n        return this._panel.board.height;\n    }\n    set input(value) {\n        this._panel.board.load(value, this._dictionary);\n    }\n    get input() {\n        return this._panel.board.input;\n    }\n    get sequence() {\n        return this._panel.GetCurrentSequence();\n    }\n    set scrollerType(value) {\n        this._scrollerType = value;\n        this._panel.scroller = ScrollerBuilder.build(value);\n    }\n    get scrollerType() {\n        return this._scrollerType;\n    }\n    get reverse() {\n        return this._panel.reverse;\n    }\n    set increment(value) {\n        this._panel.increment = value;\n    }\n    get increment() {\n        return this._panel.increment;\n    }\n    set reverse(value) {\n        this._panel.reverse = value;\n    }\n    set viewportWidth(value) {\n        this._panel.width = value;\n    }\n    get viewportWidth() {\n        return this._panel.width;\n    }\n    _validateParameters(params) {\n        let defaultParams = {\n            increment: 1,\n            scrollerType: ScrollerType.SideScrollingPanel,\n            reverse: false,\n            panelWidth: 80,\n            letterSpacing: 2,\n            padding: [0, 4],\n            size: 1\n        };\n        if (params) {\n            params.letterSpacing = this._valueOrDefault(params.letterSpacing, defaultParams.letterSpacing);\n            params.padding = this._valueOrDefault(params.padding, defaultParams.padding);\n            params.size = this._valueOrDefault(params.size, defaultParams.size);\n            params.increment = this._valueOrDefault(params.increment, defaultParams.increment);\n            params.scrollerType = this._valueOrDefault(params.scrollerType, defaultParams.scrollerType);\n            ;\n            params.reverse = this._valueOrDefault(params.reverse, defaultParams.reverse);\n            params.panelWidth = this._valueOrDefault(params.panelWidth, defaultParams.panelWidth);\n            return params;\n        }\n        return defaultParams;\n    }\n    _valueOrDefault(value, defaultValue) {\n        return value ? value : defaultValue;\n    }\n}\n//# sourceMappingURL=led-matrix.js.map","export class Renderer {\n    constructor(parameters) {\n    }\n    render(display) {\n        if (this._parameters.element == null) {\n            this._parameters.element = document.getElementById(this._parameters.elementId);\n            if (this._parameters.element == null) {\n                throw `Could not find the element to render led matrix`;\n            }\n        }\n        else {\n            if (this._parameters.element.clientHeight == 0 || this._parameters.element.clientWidth == 0) {\n                this._parameters.element = document.getElementById(this._parameters.elementId);\n            }\n        }\n    }\n}\n//# sourceMappingURL=renderer.js.map","import { Renderer } from \"./renderer\";\nexport class CanvaRenderer extends Renderer {\n    constructor(parameters) {\n        super(parameters);\n        this._parameters = {\n            elementId: parameters.elementId,\n            element: parameters.element,\n            colorBitOn: parameters.colorBitOn ? parameters.colorBitOn : \"#00B16A\",\n            colorBitOff: parameters.colorBitOff ? parameters.colorBitOff : \"#22313F\",\n            colorStrokeOn: parameters.colorStrokeOn ? parameters.colorStrokeOn : \"#67809F\",\n            colorStrokeOff: parameters.colorStrokeOff ? parameters.colorStrokeOff : \"#67809F\"\n        };\n    }\n    get parameters() {\n        return this._parameters;\n    }\n    get element() {\n        return this._parameters.element;\n    }\n    render(display) {\n        super.render(display);\n        const ctx = this.element.getContext(\"2d\");\n        if (this.element.width != this.element.clientWidth && this.element.clientWidth != 0) {\n            this.element.width = this.element.clientWidth;\n        }\n        if (this.element.height != this.element.clientHeight && this.element.clientHeight != 0) {\n            this.element.height = this.element.clientHeight;\n        }\n        ctx.clearRect(0, 0, this.element.width, this.element.height);\n        const widthEachBit = Math.floor(this.element.width / display[0].length);\n        const heightEachBit = Math.floor(this.element.height / display.length);\n        ctx.lineWidth = 1;\n        const renderBitsOfValue = (value, fillColor, strokeColor) => {\n            ctx.strokeStyle = strokeColor;\n            ctx.fillStyle = fillColor;\n            ctx.beginPath();\n            for (var i = 0; i < display.length; i++) {\n                for (var j = 0; j < display[i].length; j++) {\n                    if (display[i][j] == value) {\n                        this.moveToNextBit(ctx, i, j, widthEachBit, heightEachBit);\n                        this.drawBit(ctx, i, j, widthEachBit, heightEachBit);\n                    }\n                }\n            }\n            ctx.fill();\n            ctx.stroke();\n        };\n        renderBitsOfValue(0, this._parameters.colorBitOff, this._parameters.colorStrokeOff);\n        renderBitsOfValue(1, this._parameters.colorBitOn, this._parameters.colorStrokeOn);\n    }\n}\n//# sourceMappingURL=canva-renderer.js.map","import { CanvaRenderer } from \"./canva-renderer\";\nexport var CanvaRenderers;\n(function (CanvaRenderers) {\n    class Ellipse extends CanvaRenderer {\n        constructor(parameters) {\n            super(parameters);\n        }\n        moveToNextBit(ctx, i, j, w, h) {\n            ctx.moveTo(w * (j + 1), h * (i + 1) - h / 2);\n        }\n        drawBit(ctx, i, j, w, h) {\n            const radW = w / 2;\n            const radH = h / 2;\n            ctx.ellipse(w * j + radW, h * i + radH, radW, radH, 0, 0, 2 * Math.PI);\n        }\n    }\n    CanvaRenderers.Ellipse = Ellipse;\n    class Rect extends CanvaRenderer {\n        constructor(parameters) {\n            super(parameters);\n        }\n        drawBit(context, i, j, w, h) {\n            return context.rect(w * j, h * i, w, h);\n        }\n        moveToNextBit(ctx, i, j, w, h) {\n        }\n    }\n    CanvaRenderers.Rect = Rect;\n})(CanvaRenderers || (CanvaRenderers = {}));\n//# sourceMappingURL=canva-renderers.js.map","import { Renderer } from \"./renderer\";\nexport default class AsciiRenderer extends Renderer {\n    constructor(parameters) {\n        super(parameters);\n        this._parameters = {\n            elementId: parameters.elementId,\n            element: parameters.element,\n            characterBitOn: parameters.characterBitOn ? parameters.characterBitOn : \"X\",\n            characterBitOff: parameters.characterBitOff ? parameters.characterBitOff : \" \"\n        };\n    }\n    get parameters() {\n        return this._parameters;\n    }\n    render(display) {\n        super.render(display);\n        let output = \"\";\n        for (var i = 0; i < display.length; i++) {\n            for (var j = 0; j < display[i].length; j++) {\n                output += display[i][j] == 1 ?\n                    this._parameters.characterBitOn :\n                    this._parameters.characterBitOff;\n            }\n            output += '\\n';\n        }\n        this._parameters.element.innerHTML = output;\n    }\n}\n//# sourceMappingURL=ascii-renderer.js.map","import { CanvaRenderers } from \"./canva-renderers\";\nimport AsciiRenderer from \"./ascii-renderer\";\nexport var RendererType;\n(function (RendererType) {\n    RendererType[RendererType[\"ASCII\"] = 0] = \"ASCII\";\n    RendererType[RendererType[\"CanvasSquare\"] = 1] = \"CanvasSquare\";\n    RendererType[RendererType[\"CanvasCircle\"] = 2] = \"CanvasCircle\";\n})(RendererType || (RendererType = {}));\nexport class RendererBuilder {\n    static build(rendererType, elementId) {\n        switch (rendererType) {\n            case RendererType.ASCII:\n                return new AsciiRenderer({\n                    elementId: elementId\n                });\n            case RendererType.CanvasSquare:\n                return new CanvaRenderers.Rect({\n                    elementId: elementId\n                });\n            case RendererType.CanvasCircle:\n                return new CanvaRenderers.Ellipse({\n                    elementId: elementId\n                });\n        }\n    }\n}\n//# sourceMappingURL=renderer-builder.js.map","import { Event } from '../utils/event';\nimport { Exception } from '../utils/exception';\nimport { RendererBuilder } from './rendering/renderer-builder';\nexport class PanelPlayer {\n    constructor(params) {\n        this.CLASS_NAME = PanelPlayer.name;\n        this.onPanelUpdate = new Event();\n        this.onReachingBoundary = new Event();\n        this._index = 0;\n        this.fps = params.fps;\n        this._renderer = params.renderer;\n        this._sequence = params.sequence;\n    }\n    get PanelUpdate() { return this.onPanelUpdate.expose(); }\n    get ReachingBoundary() { return this.onReachingBoundary.expose(); }\n    get sequence() {\n        return this._sequence;\n    }\n    get index() {\n        return this._index;\n    }\n    get fps() {\n        return this._fps;\n    }\n    get renderer() {\n        return this._renderer;\n    }\n    set sequence(value) {\n        Exception.throwIfNull(value, Exception.getDescriptionForProperty(this.CLASS_NAME, 'sequence'));\n        this._sequence = value;\n    }\n    set fps(value) {\n        const fpsDescription = Exception.getDescriptionForProperty(this.CLASS_NAME, 'fps');\n        Exception.throwIfNull(value, fpsDescription);\n        Exception.throwIfNotBetween(value, fpsDescription, 0, 60);\n        this._fps = value;\n        this._fpsIntervalLengthInMs = 1000 / this._fps;\n    }\n    set renderer(value) {\n        Exception.throwIfNull(value, Exception.getDescriptionForProperty(this.CLASS_NAME, 'renderer'));\n        this._renderer = value;\n        this._render();\n    }\n    play() {\n        this._index = 0;\n        this._render();\n        this._startLoop();\n    }\n    stop() {\n        this._index = 0;\n        this._render();\n        this._shouldUpdate = false;\n    }\n    resume() {\n        this._startLoop();\n    }\n    pause() {\n        this._shouldUpdate = false;\n    }\n    step() {\n        this._nextPanelFrame();\n    }\n    seek(frame) {\n        const seekDescription = Exception.getDescriptionForProperty(this.CLASS_NAME, 'seek');\n        Exception.throwIfNull(frame, seekDescription);\n        Exception.throwIfNotBetween(frame, seekDescription, 0, this._sequence.length);\n        this._index = frame;\n        this._render();\n    }\n    setRendererFromBuilder(value) {\n        this.renderer = RendererBuilder.build(value.rendererType, value.elementId);\n    }\n    _nextPanelFrame() {\n        Exception.throwIfNull(this._sequence, Exception.getDescriptionForProperty(this.CLASS_NAME, 'sequence'));\n        this._incrementIndex();\n        this._render();\n    }\n    _render() {\n        this.onPanelUpdate.trigger({ display: this._sequence[this._index] });\n        this._renderer.render(this._sequence[this._index]);\n    }\n    _incrementIndex() {\n        const reachedBoundary = this._index >= this._sequence.length;\n        if (reachedBoundary) {\n            this.onReachingBoundary.trigger();\n        }\n        this._index = (this._index + 1) % this._sequence.length;\n    }\n    _startLoop() {\n        this._then = Date.now();\n        this._shouldUpdate = true;\n        this._loop();\n    }\n    _loop() {\n        requestAnimationFrame(this._loop.bind(this));\n        if (this._shouldUpdate) {\n            this._callIfReadyForNextFrame(this._nextPanelFrame.bind(this));\n        }\n    }\n    _callIfReadyForNextFrame(callback) {\n        this._now = Date.now();\n        this._elapsed = this._now - this._then;\n        if (this._elapsed > this._fpsIntervalLengthInMs) {\n            this._then = this._now - (this._elapsed % this._fpsIntervalLengthInMs);\n            callback();\n        }\n    }\n}\n;\n//# sourceMappingURL=panel-player.js.map","export * from './lib/core/board';\nexport * from './lib/core/character';\nexport * from './lib/core/character-dictionary';\nexport * from './lib/core/character-json';\nexport * from './lib/core/character-sizer';\nexport * from './lib/core/led-matrix';\nexport * from './lib/core/panel';\nexport * from './lib/core/scrollers/scroller-builder';\nexport * from './lib/core/scrollers/side-scrolling-panel';\nexport * from './lib/core/scrollers/vertical-scrolling-panel';\nexport * from './lib/player/panel-player';\nexport * from './lib/player/rendering/renderer-builder';\nexport * from './lib/player/rendering/ascii-renderer';\nexport * from './lib/player/rendering/canva-renderer';\nexport * from './lib/player/rendering/canva-renderers';\nexport * from './lib/player/rendering/renderer';\nexport * from './lib/utils/event';\n//# sourceMappingURL=index.js.map"],"sourceRoot":""}