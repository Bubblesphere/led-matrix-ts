{"version":3,"sources":["webpack://ledMatrix/webpack/universalModuleDefinition","webpack://ledMatrix/webpack/bootstrap","webpack://ledMatrix/./dist/esm/lib/bit-array.js","webpack://ledMatrix/./dist/esm/lib/board.js","webpack://ledMatrix/./dist/esm/lib/character.js","webpack://ledMatrix/./dist/esm/lib/character-dictionary.js","webpack://ledMatrix/./dist/esm/lib/character-sizer.js","webpack://ledMatrix/./dist/esm/lib/character-json.js","webpack://ledMatrix/./dist/esm/lib/event.js","webpack://ledMatrix/./dist/esm/lib/panel.js","webpack://ledMatrix/./dist/esm/lib/panels/side-scrolling-panel.js","webpack://ledMatrix/./dist/esm/lib/panels/vertical-scrolling-panel.js","webpack://ledMatrix/./dist/esm/lib/panel-builder.js","webpack://ledMatrix/./dist/esm/lib/rendering/renderer.js","webpack://ledMatrix/./dist/esm/lib/rendering/canva-renderer.js","webpack://ledMatrix/./dist/esm/lib/rendering/canva-renderers.js","webpack://ledMatrix/./dist/esm/lib/rendering/ascii-renderer.js","webpack://ledMatrix/./dist/esm/lib/renderer-builder.js","webpack://ledMatrix/./dist/esm/lib/panel-recorder.js","webpack://ledMatrix/./dist/esm/lib/led-matrix.js","webpack://ledMatrix/./dist/esm/index.js"],"names":["BitArray","constructor","values","_bitPerIndex","_size","length","_array","Uint8Array","Math","ceil","_pointer","pushAll","size","push","value","mask","_createMask","_matchesMask","_arrayIndex","forEach","atIndex","index","atIndexRange","count","i","_arrayIndexOffset","floor","Board","params","_characters","_letterSpacing","letterSpacing","padding","characters","input","_input","x","_padding","width","paddingAndSpacingWidth","_horizontalPaddingWidth","_totalSpacingWidth","map","character","reduce","accumulator","current","height","_verticalPaddingWidth","getColumnAtIndex","_createBitOffArrayOfLength","toReturn","some","characterColumn","getColumn","concat","getRowAtIndex","charactersWithSpace","apply","getRow","slice","load","dictionnary","escapeCharacter","delimiterWord","start","end","characterBuffer","find","Array","Character","pattern","output","_pattern","_output","_width","_height","column","row","hasPattern","CharacterDictionary","filter","max","add","pendingCharacters","pendingPatterns","duplicatedPendingPatterns","array","indexOf","alreadyAddedPatterns","duplicatedPatterns","edit","pendingCharacter","edited","arr","delete","deleted","splice","NearestNeighbor","scale","matrix","factor","ratio","h1","w2","h2","finalMatrix","j","px","py","import","path","success","fetch","then","response","text","CharactersJSON","parse","catch","error","export","json","data","JSON","characterRaw","stringify","patterns","Event","handlers","on","handler","off","h","trigger","expose","onPanelUpdate","onReachingBoundary","fps","_board","board","_index","_increment","increment","display","_renderer","renderer","_reverse","reverse","PanelUpdate","ReachingBoundary","maxFps","_fps","_fpsInterval","play","_draw","_startLoop","stop","_shouldUpdate","resume","pause","seek","frame","indexUpperBound","tick","_step","_tickIndex","_resetPanel","_generateDisplay","render","_decrementIndex","_incrementIndex","Number","prototype","valueOf","_then","Date","now","_startTime","_loop","requestAnimationFrame","bind","_onNextFrame","callback","_now","_elapsed","currentIndex","PanelType","build","panelType","SideScrollingPanel","VerticalScrollingPanel","Renderer","parameters","_parameters","element","document","getElementById","elementId","clientHeight","clientWidth","colorBitOn","colorBitOff","colorStrokeOn","colorStrokeOff","ctx","getContext","clearRect","widthEachBit","heightEachBit","lineWidth","renderBitsOfValue","fillColor","strokeColor","strokeStyle","fillStyle","beginPath","moveToNextBit","drawBit","fill","stroke","CanvaRenderers","Ellipse","w","moveTo","radW","radH","ellipse","PI","Rect","context","rect","characterBitOn","characterBitOff","innerHTML","RendererType","rendererType","ASCII","CanvasSquare","CanvasCircle","PanelRecorder","getSequence","panel","sequence","panelFrame","prevIndex","onReady","_params","_validateParameters","_panelType","_panel","PanelBuilder","panelWidth","event","panelUpdate","reachingBoundary","ready","Ready","init","pathCharacters","_dictionary","addCharacter","editCharacter","deleteCharacter","loadedCharacters","usedCharacters","spacing","setRendererFromBuilder","RendererBuilder","viewportWidth","defaultParams","_valueOrDefault","defaultValue"],"mappings":"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","file":"./src/led-matrix.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ledMatrix\"] = factory();\n\telse\n\t\troot[\"ledMatrix\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export class BitArray {\n    constructor(values) {\n        this._bitPerIndex = 8;\n        this._size = values.length;\n        this._array = new Uint8Array(Math.ceil(this._size / this._bitPerIndex));\n        this._pointer = 0;\n        this.pushAll(values);\n    }\n    get size() {\n        return this._size;\n    }\n    push(value) {\n        if (this._pointer == this._size) {\n            throw `Bit array max size reached (${this._size})`;\n        }\n        const mask = this._createMask(this._pointer);\n        if (this._matchesMask(mask, this._array[this._arrayIndex(this._pointer)])) {\n            if (value === 0) {\n                this._array[this._arrayIndex(this._pointer)] ^= mask;\n            }\n        }\n        else {\n            if (value === 1) {\n                this._array[this._arrayIndex(this._pointer)] ^= mask;\n            }\n        }\n        this._pointer++;\n    }\n    pushAll(values) {\n        values.forEach((value) => {\n            this.push(value);\n        });\n    }\n    atIndex(index) {\n        if (index > this._size) {\n            throw `Index (${index}) exceeds the size of the bit array (${this._size})`;\n        }\n        const mask = this._createMask(index);\n        return this._matchesMask(mask, this._array[this._arrayIndex(index)]) ? 1 : 0;\n    }\n    atIndexRange(index, count) {\n        if (index + count - 1 > this._size) {\n            throw `Index (${index}) exceeds the size of the bit array (${this._size})`;\n        }\n        const values = [];\n        for (let i = 0; i < count; i++) {\n            const mask = this._createMask(index + i);\n            values.push(this._matchesMask(mask, this._array[this._arrayIndex(index + i)]) ? 1 : 0);\n        }\n        return values;\n    }\n    _matchesMask(mask, value) {\n        return (mask & value) != 0;\n    }\n    _createMask(index) {\n        return 1 << (this._bitPerIndex - 1) - this._arrayIndexOffset(index);\n    }\n    _arrayIndex(index) {\n        return Math.floor(index / this._bitPerIndex);\n    }\n    _arrayIndexOffset(index) {\n        return index % this._bitPerIndex;\n    }\n}\n;\n//# sourceMappingURL=bit-array.js.map","export class Board {\n    constructor(params) {\n        this._characters = [];\n        this._letterSpacing = params.letterSpacing;\n        this.padding = params.padding;\n    }\n    set letterSpacing(value) {\n        if (value == null) {\n            throw `Board's spacing cannot be set to null`;\n        }\n        if (value < 0) {\n            throw `Board's spacing cannot be set to a negative number (${value})`;\n        }\n        this._letterSpacing = value;\n    }\n    get letterSpacing() {\n        return this._letterSpacing;\n    }\n    get characters() {\n        return this._characters;\n    }\n    get input() {\n        return this._input;\n    }\n    set padding(value) {\n        value.forEach(x => {\n            if (x == null) {\n                throw `Board's padding cannot set to null`;\n            }\n            if (x < 0) {\n                throw `Board's padding cannot be set to a negative number (${value})`;\n            }\n        });\n        if (value.length == 1) {\n            this._padding = [value[0], value[0], value[0], value[0]];\n        }\n        else if (value.length == 2) {\n            this._padding = [value[0], value[1], value[0], value[1]];\n        }\n        else {\n            this._padding = value;\n        }\n    }\n    get padding() {\n        return this._padding;\n    }\n    get width() {\n        const paddingAndSpacingWidth = this._horizontalPaddingWidth() + this._totalSpacingWidth();\n        if (this._characters.length > 0) {\n            return paddingAndSpacingWidth + this._characters\n                .map(character => character.width)\n                .reduce((accumulator, current) => accumulator + current);\n        }\n        else {\n            return paddingAndSpacingWidth;\n        }\n    }\n    get height() {\n        if (this._characters.length > 0) {\n            return this._verticalPaddingWidth() +\n                this._characters\n                    .reduce((accumulator, current) => current.height > accumulator.height ? current : accumulator).height;\n        }\n        else {\n            return this._verticalPaddingWidth();\n        }\n    }\n    getColumnAtIndex(index) {\n        index %= this.width;\n        if (index < this._padding[3] || index >= this.width - this._padding[1]) {\n            return this._createBitOffArrayOfLength(this.height);\n        }\n        let accumulator = this._padding[3];\n        let toReturn;\n        this._characters.some((character) => {\n            accumulator += character.width;\n            if (accumulator > index) {\n                const characterColumn = character.getColumn(index - (accumulator - character.width));\n                toReturn = this._createBitOffArrayOfLength(this._padding[0])\n                    .concat(characterColumn)\n                    .concat(this._createBitOffArrayOfLength(this._padding[2]))\n                    .concat(characterColumn.length < this.height ? this._createBitOffArrayOfLength(this.height - characterColumn.length) : []);\n                return true;\n            }\n            accumulator += this._letterSpacing;\n            if (accumulator > index) {\n                toReturn = this._createBitOffArrayOfLength(this.height);\n                return true;\n            }\n        });\n        return toReturn;\n    }\n    getRowAtIndex(index) {\n        index %= this.height;\n        if (index < this._padding[0] || index >= this.height - this._padding[2]) {\n            return this._createBitOffArrayOfLength(this.width);\n        }\n        let charactersWithSpace = [].concat.apply([], this._characters.map(x => x.getRow(index - this._padding[0]).concat(this._createBitOffArrayOfLength(this._letterSpacing))));\n        charactersWithSpace = charactersWithSpace.slice(0, charactersWithSpace.length - this._letterSpacing);\n        return this._createBitOffArrayOfLength(this._padding[3])\n            .concat(charactersWithSpace)\n            .concat(this._createBitOffArrayOfLength(this._padding[1]));\n    }\n    load(input, dictionnary) {\n        const escapeCharacter = '~';\n        const delimiterWord = {\n            start: \"(\",\n            end: \")\"\n        };\n        this._characters = [];\n        for (let i = 0; i < input.length; i++) {\n            let characterBuffer = input[i];\n            if (characterBuffer === escapeCharacter) {\n                if (i == input.length - 1) {\n                    throw `No character escaped at the end of the string input`;\n                }\n                characterBuffer = input[++i];\n            }\n            else if (characterBuffer === delimiterWord.start && (i === 0 || input[i - 1] !== escapeCharacter)) {\n                do {\n                    characterBuffer += input[++i];\n                    if (i == input.length) {\n                        throw `Could not find the ending delimiter \"${delimiterWord.end}\" for pattern ${characterBuffer}`;\n                    }\n                } while (input[i] != delimiterWord.end);\n                characterBuffer = characterBuffer.slice(1, -1);\n            }\n            this._characters.push(dictionnary.find(characterBuffer));\n        }\n        this._input = input;\n    }\n    _horizontalPaddingWidth() {\n        return this._padding[1] + this._padding[3];\n    }\n    _totalSpacingWidth() {\n        return (this._characters.length - 1) * this._letterSpacing;\n    }\n    _verticalPaddingWidth() {\n        return this._padding[0] + this._padding[2];\n    }\n    _createBitOffArrayOfLength(length) {\n        return Array.apply(null, Array(length)).map(() => 0);\n    }\n}\n;\n//# sourceMappingURL=board.js.map","export class Character {\n    constructor(pattern, output, width) {\n        this._pattern = pattern;\n        this._output = output;\n        if (output.size >= width) {\n            this._width = width;\n        }\n        else {\n            throw `Output size (${output.size}) can't be smaller than the character's width (${width})`;\n        }\n        if (output.size % width === 0) {\n            this._height = output.size / width;\n        }\n        else {\n            throw `Output size (${output.size}) must be divisible by the character's width (${width})`;\n        }\n    }\n    getColumn(index) {\n        if (index < 0) {\n            throw `Index (${index}) cannot be negative`;\n        }\n        if (index >= this._width) {\n            throw `Index (${index}) is greater than the width of the character (${this._width})`;\n        }\n        let column = [];\n        for (let i = 0; i < this._height; i++) {\n            column.push(this._output.atIndex(i * this._width + index));\n        }\n        return column;\n    }\n    getRow(index) {\n        if (index < 0) {\n            throw `Index (${index}) cannot be negative`;\n        }\n        if (index >= this._height) {\n            throw `Index (${index}) is greater than the height of the character (${this._height})`;\n        }\n        let row = [];\n        for (let i = 0; i < this._width; i++) {\n            row.push(this._output.atIndex(index * this._width + i));\n        }\n        return row;\n    }\n    get width() {\n        return this._width;\n    }\n    get height() {\n        return this._height;\n    }\n    get pattern() {\n        return this._pattern;\n    }\n    get output() {\n        return this._output;\n    }\n    hasPattern(input) {\n        return this._pattern == input;\n    }\n}\n;\n//# sourceMappingURL=character.js.map","export class CharacterDictionary {\n    constructor() {\n        this._characters = [];\n    }\n    find(input) {\n        const character = this._characters.filter(x => x.hasPattern(input));\n        if (character && character.length > 0) {\n            return character[0];\n        }\n        throw `Could not find character ${input} in the alphabet`;\n    }\n    get characters() {\n        return this._characters;\n    }\n    get height() {\n        return Math.max.apply(Math, this._characters.map(x => x.height));\n    }\n    get length() {\n        return this._characters.length;\n    }\n    add(pendingCharacters) {\n        const pendingPatterns = pendingCharacters.map(x => x.pattern);\n        const duplicatedPendingPatterns = pendingPatterns.filter((value, index, array) => {\n            return array.indexOf(value) != index;\n        });\n        if (duplicatedPendingPatterns.length > 0) {\n            throw `Pattern already used by another pending character`;\n        }\n        if (this._characters.length > 0) {\n            const alreadyAddedPatterns = this._characters.map(x => x.pattern);\n            const duplicatedPatterns = alreadyAddedPatterns.filter((value) => {\n                return pendingPatterns.indexOf(value) != -1;\n            });\n            if (duplicatedPatterns.length > 0) {\n                throw `Pattern already used by another character`;\n            }\n        }\n        this._characters.push(...pendingCharacters);\n    }\n    edit(pendingCharacter) {\n        let edited = false;\n        this._characters.forEach((character, index, arr) => {\n            if (character.pattern == pendingCharacter.pattern && !edited) {\n                arr[index] = pendingCharacter;\n                edited = true;\n            }\n        });\n        if (!edited) {\n            throw `Could not find character ${pendingCharacter.pattern} in the alphabet. Aborted edit operation`;\n        }\n    }\n    delete(pendingCharacter) {\n        let deleted = false;\n        this._characters.forEach((character, index, arr) => {\n            if (character.pattern == pendingCharacter.pattern && !deleted) {\n                arr.splice(index, 1);\n                deleted = true;\n            }\n        });\n        if (!deleted) {\n            throw `Could not find character ${pendingCharacter.pattern} in the alphabet. Aborted delete operation`;\n        }\n    }\n}\n;\n//# sourceMappingURL=character-dictionary.js.map","export class NearestNeighbor {\n    static scale(matrix, width, factor) {\n        const ratio = 1 / factor;\n        const h1 = matrix.length / width;\n        const w2 = width * factor;\n        const h2 = h1 * factor;\n        let finalMatrix = new Array(w2 * h2);\n        for (let i = 0; i < h2; i++) {\n            for (let j = 0; j < w2; j++) {\n                const px = Math.floor(j * ratio);\n                const py = Math.floor(i * ratio);\n                finalMatrix[(i * w2) + j] = matrix[(py * width) + px];\n            }\n        }\n        return finalMatrix;\n    }\n}\n//# sourceMappingURL=character-sizer.js.map","import { Character } from \"./character\";\nimport { BitArray } from \"./bit-array\";\nimport { NearestNeighbor } from \"./character-sizer\";\nexport class CharactersJSON {\n    static import(path, size, success) {\n        fetch(path)\n            .then((response) => {\n            return response.text();\n        })\n            .then((response) => {\n            success(CharactersJSON.parse(response, size));\n        })\n            .catch((error) => {\n            throw `Couldn't fetch file: ${path}`;\n        });\n    }\n    static export() {\n    }\n    static parse(json, size) {\n        if (size < 1 || size > 10) {\n            throw 'Size should be between 1 and 10';\n        }\n        const data = JSON.parse(json);\n        if (data == null) {\n            throw 'Invalid character json file';\n        }\n        if (data.characters == null) {\n            throw 'Invalid character json file: Can\\'t find property characters';\n        }\n        return data.characters.map(x => {\n            if (x.pattern == null) {\n                throw 'Invalid character json file: Can\\'t find property patterns for a character';\n            }\n            if (x.output == null) {\n                throw 'Invalid character json file: Can\\'t find property output for a character';\n            }\n            if (x.width == null) {\n                throw 'Invalid character json file: Can\\'t find property width for a character';\n            }\n            const characterRaw = x.output.map(x => x);\n            const character = NearestNeighbor.scale(characterRaw, x.width, size);\n            return new Character(x.pattern, new BitArray(character), x.width * size);\n        });\n    }\n    static stringify(characters) {\n        if (characters == null || characters.length == 0) {\n            return JSON.stringify(\"\");\n        }\n        return JSON.stringify({\n            characters: characters.map(x => {\n                return {\n                    patterns: x.pattern,\n                    output: x.output.atIndexRange(0, x.output.size),\n                    width: x.width\n                };\n            })\n        });\n    }\n}\n//# sourceMappingURL=character-json.js.map","export class Event {\n    constructor() {\n        this.handlers = [];\n    }\n    on(handler) {\n        this.handlers.push(handler);\n    }\n    off(handler) {\n        this.handlers = this.handlers.filter(h => h !== handler);\n    }\n    trigger(data) {\n        this.handlers.slice(0).forEach(h => h(data));\n    }\n    expose() {\n        return this;\n    }\n}\n//# sourceMappingURL=event.js.map","import { Event } from './event';\nexport class Panel {\n    constructor(params) {\n        this.onPanelUpdate = new Event();\n        this.onReachingBoundary = new Event();\n        this.width = params.width;\n        this.fps = params.fps;\n        this._board = params.board;\n        this._index = 0;\n        this._increment = params.increment;\n        this.display = [];\n        this._renderer = params.renderer;\n        this._reverse = params.reverse;\n    }\n    get PanelUpdate() { return this.onPanelUpdate.expose(); }\n    get ReachingBoundary() { return this.onReachingBoundary.expose(); }\n    get index() {\n        return this._index;\n    }\n    set width(value) {\n        if (value == null) {\n            throw `Panel's width cannot be set to null`;\n        }\n        if (value < 0) {\n            throw `Panel's width cannot be set to a negative number (${value})`;\n        }\n        this._width = value;\n    }\n    get width() {\n        return this._width;\n    }\n    set fps(value) {\n        if (value == null) {\n            throw `Panel's fps cannot be set to null`;\n        }\n        if (value < 0) {\n            throw `Panel's fps cannot be set to a negative number (${value})`;\n        }\n        const maxFps = 60;\n        if (value > maxFps) {\n            throw `Panel's fps has to be lower than ${maxFps}`;\n        }\n        this._fps = value;\n        this._fpsInterval = 1000 / this._fps;\n    }\n    get fps() {\n        return this._fps;\n    }\n    set board(value) {\n        if (value == null) {\n            throw `Panel's board cannot be set to null`;\n        }\n        this._board = value;\n    }\n    get board() {\n        return this._board;\n    }\n    set increment(value) {\n        if (value == null) {\n            throw `Panel's fps cannot be set to a null value`;\n        }\n        if (value < 0) {\n            throw `Panel's fps cannot be set to a negative number (${value})`;\n        }\n        this._increment = value;\n    }\n    get increment() {\n        return this._increment;\n    }\n    set renderer(value) {\n        if (value == null) {\n            throw `Panel's renderer cannot be set to null`;\n        }\n        this._renderer = value;\n    }\n    get renderer() {\n        return this._renderer;\n    }\n    set reverse(value) {\n        if (value == null) {\n            throw `Panel's reverse cannot be set to null`;\n        }\n        this._reverse = value;\n    }\n    get reverse() {\n        return this._reverse;\n    }\n    play() {\n        this._index = 0;\n        this._draw();\n        this._startLoop();\n    }\n    stop() {\n        this._index = 0;\n        this._draw();\n        this._shouldUpdate = false;\n    }\n    resume() {\n        this._startLoop();\n    }\n    pause() {\n        this._shouldUpdate = false;\n    }\n    seek(frame) {\n        if (frame == null || frame < 0 || frame > this.indexUpperBound) {\n            throw `Seek expects a value between 0 and ${this.indexUpperBound}`;\n        }\n        this._index = frame;\n        this._draw();\n    }\n    tick() {\n        this._step();\n    }\n    _step() {\n        this._tickIndex();\n        this._draw();\n    }\n    _draw() {\n        this._resetPanel();\n        this._generateDisplay(this._index);\n        this.onPanelUpdate.trigger({ display: this.display });\n        this._renderer.render(this.display);\n    }\n    _tickIndex() {\n        this._reverse ? this._decrementIndex() : this._incrementIndex();\n    }\n    _resetPanel() {\n        this.display.splice(0, this.display.length);\n        for (let i = 0; i < this._board.height; i++) {\n            this.display.push(Array.apply(null, Array(this.width)).map(Number.prototype.valueOf, 0));\n        }\n    }\n    _incrementIndex() {\n        if (this._index >= this.indexUpperBound) {\n            this.onReachingBoundary.trigger();\n            this._index = 0;\n        }\n        else {\n            this._index += this._increment;\n        }\n    }\n    _decrementIndex() {\n        if (this._index === 0) {\n            this.onReachingBoundary.trigger();\n            this._index = this.indexUpperBound;\n        }\n        else {\n            this._index -= this._increment;\n        }\n    }\n    _startLoop() {\n        this._then = Date.now();\n        this._startTime = this._then;\n        this._shouldUpdate = true;\n        this._loop();\n    }\n    _loop() {\n        requestAnimationFrame(this._loop.bind(this));\n        if (this._shouldUpdate) {\n            this._onNextFrame(this._step.bind(this));\n        }\n    }\n    _onNextFrame(callback) {\n        this._now = Date.now();\n        this._elapsed = this._now - this._then;\n        if (this._elapsed > this._fpsInterval) {\n            this._then = this._now - (this._elapsed % this._fpsInterval);\n            callback();\n        }\n    }\n}\n;\n//# sourceMappingURL=panel.js.map","import { Panel } from \"../panel\";\nexport class SideScrollingPanel extends Panel {\n    constructor(params) {\n        super(params);\n    }\n    get indexUpperBound() {\n        return this.board.width - 1;\n    }\n    _generateDisplay(currentIndex) {\n        for (let i = 0; i < this.width; i++) {\n            let column;\n            column = this.board.getColumnAtIndex(currentIndex + i);\n            for (let j = 0; j < this.board.height; j++) {\n                this.display[j][i] = column[j];\n            }\n        }\n    }\n}\n//# sourceMappingURL=side-scrolling-panel.js.map","import { Panel } from \"../panel\";\nexport class VerticalScrollingPanel extends Panel {\n    constructor(params) {\n        super(params);\n    }\n    get indexUpperBound() {\n        return this.board.height - 1;\n    }\n    _generateDisplay(currentIndex) {\n        for (let i = 0; i < this.board.height; i++) {\n            let row;\n            row = this.board.getRowAtIndex(currentIndex + i);\n            this.display[i] = row.slice(0, this.width);\n        }\n    }\n}\n//# sourceMappingURL=vertical-scrolling-panel.js.map","import { SideScrollingPanel } from \"./panels/side-scrolling-panel\";\nimport { VerticalScrollingPanel } from \"./panels/vertical-scrolling-panel\";\nexport var PanelType;\n(function (PanelType) {\n    PanelType[PanelType[\"SideScrollingPanel\"] = 0] = \"SideScrollingPanel\";\n    PanelType[PanelType[\"VerticalScrollingPanel\"] = 1] = \"VerticalScrollingPanel\";\n})(PanelType || (PanelType = {}));\nexport class PanelBuilder {\n    static build(panelType, params) {\n        switch (panelType) {\n            case PanelType.SideScrollingPanel:\n                return new SideScrollingPanel(params);\n            case PanelType.VerticalScrollingPanel:\n                return new VerticalScrollingPanel(params);\n        }\n    }\n}\n//# sourceMappingURL=panel-builder.js.map","export class Renderer {\n    constructor(parameters) {\n    }\n    render(display) {\n        if (this._parameters.element == null) {\n            this._parameters.element = document.getElementById(this._parameters.elementId);\n            if (this._parameters.element == null) {\n                throw `Could not find the element to render led matrix`;\n            }\n        }\n        else {\n            if (this._parameters.element.clientHeight == 0 || this._parameters.element.clientWidth == 0) {\n                this._parameters.element = document.getElementById(this._parameters.elementId);\n            }\n        }\n    }\n}\n//# sourceMappingURL=renderer.js.map","import { Renderer } from \"./renderer\";\nexport class CanvaRenderer extends Renderer {\n    constructor(parameters) {\n        super(parameters);\n        this._parameters = {\n            elementId: parameters.elementId,\n            element: parameters.element,\n            colorBitOn: parameters.colorBitOn ? parameters.colorBitOn : \"#00B16A\",\n            colorBitOff: parameters.colorBitOff ? parameters.colorBitOff : \"#22313F\",\n            colorStrokeOn: parameters.colorStrokeOn ? parameters.colorStrokeOn : \"#67809F\",\n            colorStrokeOff: parameters.colorStrokeOff ? parameters.colorStrokeOff : \"#67809F\"\n        };\n    }\n    get parameters() {\n        return this._parameters;\n    }\n    get element() {\n        return this._parameters.element;\n    }\n    render(display) {\n        super.render(display);\n        const ctx = this.element.getContext(\"2d\");\n        if (this.element.width != this.element.clientWidth && this.element.clientWidth != 0) {\n            this.element.width = this.element.clientWidth;\n        }\n        if (this.element.height != this.element.clientHeight && this.element.clientHeight != 0) {\n            this.element.height = this.element.clientHeight;\n        }\n        ctx.clearRect(0, 0, this.element.width, this.element.height);\n        const widthEachBit = Math.floor(this.element.width / display[0].length);\n        const heightEachBit = Math.floor(this.element.height / display.length);\n        ctx.lineWidth = 1;\n        const renderBitsOfValue = (value, fillColor, strokeColor) => {\n            ctx.strokeStyle = strokeColor;\n            ctx.fillStyle = fillColor;\n            ctx.beginPath();\n            for (var i = 0; i < display.length; i++) {\n                for (var j = 0; j < display[i].length; j++) {\n                    if (display[i][j] == value) {\n                        this.moveToNextBit(ctx, i, j, widthEachBit, heightEachBit);\n                        this.drawBit(ctx, i, j, widthEachBit, heightEachBit);\n                    }\n                }\n            }\n            ctx.fill();\n            ctx.stroke();\n        };\n        renderBitsOfValue(0, this._parameters.colorBitOff, this._parameters.colorStrokeOff);\n        renderBitsOfValue(1, this._parameters.colorBitOn, this._parameters.colorStrokeOn);\n    }\n}\n//# sourceMappingURL=canva-renderer.js.map","import { CanvaRenderer } from \"./canva-renderer\";\nexport var CanvaRenderers;\n(function (CanvaRenderers) {\n    class Ellipse extends CanvaRenderer {\n        constructor(parameters) {\n            super(parameters);\n        }\n        moveToNextBit(ctx, i, j, w, h) {\n            ctx.moveTo(w * (j + 1), h * (i + 1) - h / 2);\n        }\n        drawBit(ctx, i, j, w, h) {\n            const radW = w / 2;\n            const radH = h / 2;\n            ctx.ellipse(w * j + radW, h * i + radH, radW, radH, 0, 0, 2 * Math.PI);\n        }\n    }\n    CanvaRenderers.Ellipse = Ellipse;\n    class Rect extends CanvaRenderer {\n        constructor(parameters) {\n            super(parameters);\n        }\n        drawBit(context, i, j, w, h) {\n            return context.rect(w * j, h * i, w, h);\n        }\n        moveToNextBit(ctx, i, j, w, h) {\n        }\n    }\n    CanvaRenderers.Rect = Rect;\n})(CanvaRenderers || (CanvaRenderers = {}));\n//# sourceMappingURL=canva-renderers.js.map","import { Renderer } from \"./renderer\";\nexport class AsciiRenderer extends Renderer {\n    constructor(parameters) {\n        super(parameters);\n        this._parameters = {\n            elementId: parameters.elementId,\n            element: parameters.element,\n            characterBitOn: parameters.characterBitOn ? parameters.characterBitOn : \"X\",\n            characterBitOff: parameters.characterBitOff ? parameters.characterBitOff : \" \"\n        };\n    }\n    get parameters() {\n        return this._parameters;\n    }\n    render(display) {\n        super.render(display);\n        let output = \"\";\n        for (var i = 0; i < display.length; i++) {\n            for (var j = 0; j < display[i].length; j++) {\n                output += display[i][j] == 1 ?\n                    this._parameters.characterBitOn :\n                    this._parameters.characterBitOff;\n            }\n            output += '\\n';\n        }\n        this._parameters.element.innerHTML = output;\n    }\n}\n//# sourceMappingURL=ascii-renderer.js.map","import { CanvaRenderers } from \"./rendering/canva-renderers\";\nimport { AsciiRenderer } from \"./rendering/ascii-renderer\";\nexport var RendererType;\n(function (RendererType) {\n    RendererType[RendererType[\"ASCII\"] = 0] = \"ASCII\";\n    RendererType[RendererType[\"CanvasSquare\"] = 1] = \"CanvasSquare\";\n    RendererType[RendererType[\"CanvasCircle\"] = 2] = \"CanvasCircle\";\n})(RendererType || (RendererType = {}));\nexport class RendererBuilder {\n    static build(rendererType, elementId) {\n        switch (rendererType) {\n            case RendererType.ASCII:\n                return new AsciiRenderer({\n                    elementId: elementId\n                });\n            case RendererType.CanvasSquare:\n                return new CanvaRenderers.Rect({\n                    elementId: elementId\n                });\n            case RendererType.CanvasCircle:\n                return new CanvaRenderers.Ellipse({\n                    elementId: elementId\n                });\n        }\n    }\n}\n//# sourceMappingURL=renderer-builder.js.map","export class PanelRecorder {\n    static getSequence(panel) {\n        let sequence = [];\n        panel.PanelUpdate.on((panelFrame) => {\n            sequence.push(panelFrame.display);\n        });\n        let prevIndex = panel.index;\n        let i = 0;\n        panel.seek(0);\n        for (let i = 0; i <= panel.indexUpperBound; i++) {\n            panel.tick();\n        }\n        panel.seek(prevIndex);\n        return sequence;\n    }\n}\n//# sourceMappingURL=panel-recorder.js.map","import { Board } from \"./board\";\nimport { PanelBuilder, PanelType } from \"./panel-builder\";\nimport { RendererBuilder, RendererType } from \"./renderer-builder\";\nimport { Event } from \"./event\";\nimport { CharacterDictionary } from \"./character-dictionary\";\nimport { CharactersJSON } from \"./character-json\";\nimport { PanelRecorder } from './panel-recorder';\nexport class LedMatrix {\n    constructor(params) {\n        this.onReady = new Event();\n        this._params = this._validateParameters(params);\n        this._board = new Board({\n            letterSpacing: this._params.letterSpacing,\n            padding: this._params.padding\n        });\n        this._panelType = this._params.panelType;\n        this._panel = PanelBuilder.build(this._params.panelType, {\n            board: this._board,\n            renderer: this._params.renderer,\n            fps: this._params.fps,\n            increment: this._params.increment,\n            reverse: this._params.reverse,\n            width: this._params.panelWidth\n        });\n        this.event = {\n            panelUpdate: this._panel.PanelUpdate,\n            reachingBoundary: this._panel.ReachingBoundary,\n            ready: this.Ready\n        };\n    }\n    get Ready() { return this.onReady.expose(); }\n    init(size, callback) {\n        CharactersJSON.import(this._params.pathCharacters, size ? size : 1, (characters) => {\n            this._dictionary = new CharacterDictionary();\n            this._dictionary.add(characters);\n            this._board.load(this._board.input != null ? this._board.input : this._params.input, this._dictionary);\n            this.onReady.trigger();\n            if (callback) {\n                callback();\n            }\n        });\n    }\n    get size() {\n        return this._size;\n    }\n    set size(value) {\n        this._size = value;\n        this.init(value);\n    }\n    get index() {\n        return this._panel.index;\n    }\n    get indexUpperBound() {\n        return this._panel.indexUpperBound;\n    }\n    getSequence() {\n        return PanelRecorder.getSequence(this._panel);\n    }\n    addCharacter(character) {\n        this._dictionary.add([character]);\n    }\n    editCharacter(character) {\n        this._dictionary.edit(character);\n    }\n    deleteCharacter(character) {\n        this._dictionary.delete(character);\n    }\n    get loadedCharacters() {\n        return this._dictionary.characters;\n    }\n    get usedCharacters() {\n        return this._board.characters;\n    }\n    set spacing(value) {\n        this._board.letterSpacing = value;\n        this._panel.board = this._board;\n    }\n    get spacing() {\n        return this._board.letterSpacing;\n    }\n    set padding(value) {\n        this._board.padding = value;\n        this._panel.board = this._board;\n    }\n    get padding() {\n        return this._board.padding;\n    }\n    get width() {\n        return this._board.width;\n    }\n    get height() {\n        return this._board.height;\n    }\n    set input(value) {\n        this._board.load(value, this._dictionary);\n    }\n    get input() {\n        return this._board.input;\n    }\n    play() {\n        this._panel.play();\n    }\n    stop() {\n        this._panel.stop();\n    }\n    pause() {\n        this._panel.pause();\n    }\n    resume() {\n        this._panel.resume();\n    }\n    tick() {\n        this._panel.tick();\n    }\n    seek(frame) {\n        this._panel.seek(frame);\n    }\n    set panelType(value) {\n        this._panelType = value;\n        this._panel.stop();\n        this._panel = PanelBuilder.build(this._panelType, {\n            board: this._board,\n            renderer: this._panel.renderer,\n            fps: this._panel.fps,\n            increment: this._panel.increment,\n            reverse: this._panel.reverse,\n            width: this._panel.width\n        });\n        this._panel.play();\n    }\n    get panelType() {\n        return this._panelType;\n    }\n    set renderer(value) {\n        this._panel.renderer = value;\n    }\n    setRendererFromBuilder(value) {\n        this._panel.renderer = RendererBuilder.build(value.rendererType, value.elementId);\n    }\n    get renderer() {\n        return this._panel.renderer;\n    }\n    set fps(value) {\n        this._panel.fps = value;\n    }\n    get fps() {\n        return this._panel.fps;\n    }\n    set increment(value) {\n        this._panel.increment = value;\n    }\n    get increment() {\n        return this._panel.increment;\n    }\n    set reverse(value) {\n        this._panel.reverse = value;\n    }\n    get reverse() {\n        return this._panel.reverse;\n    }\n    set viewportWidth(value) {\n        this._panel.width = value;\n    }\n    get viewportWidth() {\n        return this._panel.width;\n    }\n    _validateParameters(params) {\n        const defaultParams = {\n            input: \"hello world\",\n            pathCharacters: \"alphabet.json\",\n            fps: 30,\n            increment: 1,\n            panelType: PanelType.SideScrollingPanel,\n            rendererType: RendererType.ASCII,\n            elementId: 'led-matrix',\n            reverse: false,\n            panelWidth: 80,\n            letterSpacing: 2,\n            padding: [0, 4]\n        };\n        if (params) {\n            params.input = this._valueOrDefault(params.input, defaultParams.input);\n            params.pathCharacters = this._valueOrDefault(params.pathCharacters, defaultParams.pathCharacters);\n            params.letterSpacing = this._valueOrDefault(params.letterSpacing, defaultParams.letterSpacing);\n            params.padding = this._valueOrDefault(params.padding, defaultParams.padding);\n            params.fps = this._valueOrDefault(params.fps, defaultParams.fps);\n            params.increment = this._valueOrDefault(params.increment, defaultParams.increment);\n            params.panelType = this._valueOrDefault(params.panelType, defaultParams.panelType);\n            ;\n            params.reverse = this._valueOrDefault(params.reverse, defaultParams.reverse);\n            params.panelWidth = this._valueOrDefault(params.panelWidth, defaultParams.panelWidth);\n            if (params.renderer != null) {\n                params.renderer = params.renderer;\n            }\n            else {\n                params.rendererType = this._valueOrDefault(params.rendererType, defaultParams.rendererType);\n                params.elementId = this._valueOrDefault(params.elementId, defaultParams.elementId);\n                params.renderer = RendererBuilder.build(params.rendererType, params.elementId);\n            }\n            return params;\n        }\n        return defaultParams;\n    }\n    _valueOrDefault(value, defaultValue) {\n        return value ? value : defaultValue;\n    }\n}\n//# sourceMappingURL=led-matrix.js.map","export * from './lib/bit-array';\nexport * from './lib/board';\nexport * from './lib/character';\nexport * from './lib/character-dictionary';\nexport * from './lib/character-json';\nexport * from './lib/character-sizer';\nexport * from './lib/event';\nexport * from './lib/led-matrix';\nexport * from './lib/panel';\nexport * from './lib/panel-builder';\nexport * from './lib/renderer-builder';\nexport * from './lib/panels/side-scrolling-panel';\nexport * from './lib/panels/vertical-scrolling-panel';\nexport * from './lib/rendering/ascii-renderer';\nexport * from './lib/rendering/canva-renderer';\nexport * from './lib/rendering/canva-renderers';\nexport * from './lib/rendering/renderer';\n//# sourceMappingURL=index.js.map"],"sourceRoot":""}